imports:
    - deptrac.base.yaml
    - deptrac.modules.baseline.yaml

parameters:
    layers:
        -   name: Vendor
            collectors:
                -   type: bool
                    must: [ { type: className, value: ((.+\\.*)|.*_.*) } ]
                    must_not: [ { type: directory, value: src/.* } ]

        # Shared
        ### Haystack_Midway
        -   name: Haystack_Midway
            collectors: [ { type: directory, regex: src/Shared/Haystack/.* } ]

        # Modules
        ### Foo
        -   name: Foo_Upstream
            collectors: [ { type: directory, regex: src/Module/Foo/UserInterface/.* } ]
        -   name: Foo_Downstream
            collectors: [ { type: directory, regex: src/Module/Foo/Infrastructure/.* } ]
        -   name: Foo
            collectors:
                -   type: bool
                    must: [ { type: directory, regex: src/Module/Foo/.* } ]
                    must_not: [ { type: layer, layer: Foo_Downstream } ]

        ### Bar
        -   name: Bar_Upstream
            collectors: [ { type: directory, regex: src/Module/Bar/UserInterface/.* } ]
        -   name: Bar_Downstream
            collectors: [ { type: directory, regex: src/Module/Bar/Infrastructure/.* } ]
        -   name: Bar
            collectors:
                -   type: bool
                    must: [ { type: directory, regex: src/Module/Bar/.* } ]
                    must_not: [ { type: layer, layer: Bar_Upstream }, { type: layer, layer: Bar_Downstream } ]

        ### Mvc
        -   name: Mvc_Upstream
            collectors: [ { type: className, value: Module\\Mvc\\MvcFacade } ]
        -   name: Mvc
            collectors:
                -   type: bool
                    must: [ { type: directory, regex: src/Module/Mvc/.* } ]
                    must_not: [ { type: layer, layer: Mvc_Upstream }, { type: layer, layer: Mvc_Downstream } ]

    ruleset:
        Haystack_Midway: [ Vendor ]

        Foo: [ Haystack_Midway ]
        Foo_Upstream: [ Foo, Vendor ]
        Foo_Downstream: [ Bar_Upstream, Vendor ]

        Bar: ~
        Bar_Upstream: [ Bar, Vendor ]
        Bar_Downstream: [ Mvc_Upstream, Vendor ]

        Mvc: [ Vendor ]
        Mvc_Upstream: [ Mvc, Vendor ]
